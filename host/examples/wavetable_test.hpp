//
// Copyright 2010-2012,2014 Ettus Research LLC
// Copyright 2018 Ettus Research, a National Instruments Company
//
// SPDX-License-Identifier: GPL-3.0-or-later
//

#include <cmath>
#include <complex>
#include <stdexcept>
#include <string>
#include <vector>
#include <iostream>

static const size_t wave_table_len = 8192;

static const float imag_wave_table[8192] = {0,-0.485700635381625,0.595151589439844,-0.0598634598684133,-0.846777692679336,-0.363878110966621,-0.693589654772962,0.472681450063903,-0.287556041953468,0.515069304725566,0.374720484394322,-0.310370287495839,-0.114032898828645,0.709438699241802,0.0785668917852334,0.692934429339296,0.48479985764729,0.613852241962736,0.222630337964704,-0.700783793853777,0.947267801000285,0.65734507783558,0.266315706292473,-0.564904889163399,0.185313911731058,-0.360703872423156,-0.424275931477123,-0.330977557463678,-0.30792729416968,0.201158015339992,0.622969277336804,0.649780126398936,-0.855841978664581,-0.00282400987108042,0.0859465846751246,-0.0310366641022555,0.576572342068087,-0.590635364110127,0.328912216571099,0.290525149348952,-0.305493073274417,0.31009831797799,0.55339854396528,-0.463930436093155,-0.128823864481316,-0.430569410540716,-0.429453628979227,-0.487551282313888,-0.0840324683116807,0.122392560760432,0.0486130338287275,-0.100568469351778,0.693903761108624,-0.296984337074491,0.02107001354868,0.936771405070468,0.600010182327552,-0.000548626710258587,0.484651904235266,0.11976211098281,-0.338951075166736,-0.370511644558014,-0.27479969556228,0.539100989520655,0.493081099329536,0.798669498411497,-0.633962998625309,0.801355855363678,0.207608246188489,0.172041580945112,-0.638168551325898,-0.228893314940922,0.0786291183635408,0.0367808380246974,0.581073135937623,-0.295824416123839,-0.598946027375374,-0.380205737651942,-0.723835059372189,0.658922322635272,-0.597053823765691,-0.554046914824838,-0.168237875229108,-0.00593611970059812,-1,0.0496089283296671,0.116237876020311,0.729207443992557,0.0202921203619105,0.0191122678477186,-0.12138096992342,-0.571650891276925,0.26287612916898,-0.70220149559829,-0.400031075431511,-0.402874547484304,0.623401319324026,-0.606127818265459,0.31533044468474,-0.0500987578549373,-0.0708267222861086,-0.00365412865649735,0.854339897315515,0.0916144517155109,0.414819031821583,-0.111912583793368,0.104684031861198,-0.754793351638748,-0.510092102605853,0.347517530108627,-0.0571981457515502,-0.045179974990532,0.300499235079636,-0.450847065897033,0.38571749829288,0.12786483585687,-0.21330220517356,-0.0292148175802159,-0.557769492929461,-0.188834296577018,-0.247775713690567,0.912118631199828,-0.540640256727961,-0.445326321035776,-0.599423199405752,-0.181907233995787,0.720087119460895,-0.528392054147402,0,0.528392054147402,-0.720087119460895,0.181907233995787,0.599423199405752,0.445326321035776,0.540640256727961,-0.912118631199828,0.247775713690567,0.188834296577018,0.557769492929461,0.0292148175802159,0.21330220517356,-0.12786483585687,-0.38571749829288,0.450847065897033,-0.300499235079636,0.045179974990532,0.05719814575155,-0.347517530108627,0.510092102605853,0.754793351638748,-0.104684031861198,0.111912583793368,-0.414819031821583,-0.0916144517155108,-0.854339897315515,0.00365412865649728,0.0708267222861086,0.0500987578549373,-0.31533044468474,0.606127818265459,-0.623401319324026,0.402874547484304,0.400031075431511,0.70220149559829,-0.26287612916898,0.571650891276924,0.12138096992342,-0.0191122678477186,-0.0202921203619104,-0.729207443992557,-0.116237876020311,-0.0496089283296671,1,0.00593611970059812,0.168237875229108,0.554046914824838,0.597053823765691,-0.658922322635272,0.72383505937219,0.380205737651942,0.598946027375374,0.295824416123839,-0.581073135937623,-0.0367808380246975,-0.0786291183635408,0.228893314940922,0.638168551325898,-0.172041580945112,-0.207608246188489,-0.801355855363678,0.633962998625309,-0.798669498411497,-0.493081099329536,-0.539100989520656,0.27479969556228,0.370511644558014,0.338951075166736,-0.11976211098281,-0.484651904235266,0.000548626710258533,-0.600010182327552,-0.936771405070468,-0.0210700135486799,0.296984337074491,-0.693903761108624,0.100568469351777,-0.0486130338287277,-0.122392560760432,0.0840324683116806,0.487551282313888,0.429453628979227,0.430569410540716,0.128823864481316,0.463930436093155,-0.55339854396528,-0.31009831797799,0.305493073274417,-0.290525149348952,-0.328912216571099,0.590635364110127,-0.576572342068087,0.0310366641022556,-0.0859465846751246,0.00282400987108049,0.855841978664581,-0.649780126398936,-0.622969277336804,-0.201158015339992,0.30792729416968,0.330977557463678,0.424275931477122,0.360703872423156,-0.185313911731058,0.564904889163399,-0.266315706292473,-0.65734507783558,-0.947267801000285,0.700783793853777,-0.222630337964703,-0.613852241962736,-0.48479985764729,-0.692934429339296,-0.0785668917852335,-0.709438699241802,0.114032898828645,0.310370287495839,-0.374720484394322,-0.515069304725566,0.287556041953468,-0.472681450063903,0.693589654772962,0.363878110966621,0.846777692679336,0.0598634598684133,-0.595151589439845,0.485700635381625,0,-0.485700635381625,0.595151589439844,-0.0598634598684133,-0.846777692679336,-0.363878110966621,-0.693589654772962,0.472681450063903,-0.287556041953468,0.515069304725566,0.374720484394322,-0.310370287495839,-0.114032898828645,0.709438699241802,0.0785668917852334,0.692934429339296,0.48479985764729,0.613852241962736,0.222630337964704,-0.700783793853777,0.947267801000285,0.65734507783558,0.266315706292473,-0.564904889163399,0.185313911731058,-0.360703872423156,-0.424275931477123,-0.330977557463678,-0.30792729416968,0.201158015339992,0.622969277336804,0.649780126398936,-0.855841978664581,-0.00282400987108042,0.0859465846751246,-0.0310366641022555,0.576572342068087,-0.590635364110127,0.328912216571099,0.290525149348952,-0.305493073274417,0.31009831797799,0.55339854396528,-0.463930436093155,-0.128823864481316,-0.430569410540716,-0.429453628979227,-0.487551282313888,-0.0840324683116807,0.122392560760432,0.0486130338287275,-0.100568469351778,0.693903761108624,-0.296984337074491,0.02107001354868,0.936771405070468,0.600010182327552,-0.000548626710258587,0.484651904235266,0.11976211098281,-0.338951075166736,-0.370511644558014,-0.27479969556228,0.539100989520655,0.493081099329536,0.798669498411497,-0.633962998625309,0.801355855363678,0.207608246188489,0.172041580945112,-0.638168551325898,-0.228893314940922,0.0786291183635408,0.0367808380246974,0.581073135937623,-0.295824416123839,-0.598946027375374,-0.380205737651942,-0.723835059372189,0.658922322635272,-0.597053823765691,-0.554046914824838,-0.168237875229108,-0.00593611970059812,-1,0.0496089283296671,0.116237876020311,0.729207443992557,0.0202921203619105,0.0191122678477186,-0.12138096992342,-0.571650891276925,0.26287612916898,-0.70220149559829,-0.400031075431511,-0.402874547484304,0.623401319324026,-0.606127818265459,0.31533044468474,-0.0500987578549373,-0.0708267222861086,-0.00365412865649735,0.854339897315515,0.0916144517155109,0.414819031821583,-0.111912583793368,0.104684031861198,-0.754793351638748,-0.510092102605853,0.347517530108627,-0.0571981457515502,-0.045179974990532,0.300499235079636,-0.450847065897033,0.38571749829288,0.12786483585687,-0.21330220517356,-0.0292148175802159,-0.557769492929461,-0.188834296577018,-0.247775713690567,0.912118631199828,-0.540640256727961,-0.445326321035776,-0.599423199405752,-0.181907233995787,0.720087119460895,-0.528392054147402,0,0.528392054147402,-0.720087119460895,0.181907233995787,0.599423199405752,0.445326321035776,0.540640256727961,-0.912118631199828,0.247775713690567,0.188834296577018,0.557769492929461,0.0292148175802159,0.21330220517356,-0.12786483585687,-0.38571749829288,0.450847065897033,-0.300499235079636,0.045179974990532,0.05719814575155,-0.347517530108627,0.510092102605853,0.754793351638748,-0.104684031861198,0.111912583793368,-0.414819031821583,-0.0916144517155108,-0.854339897315515,0.00365412865649728,0.0708267222861086,0.0500987578549373,-0.31533044468474,0.606127818265459,-0.623401319324026,0.402874547484304,0.400031075431511,0.70220149559829,-0.26287612916898,0.571650891276924,0.12138096992342,-0.0191122678477186,-0.0202921203619104,-0.729207443992557,-0.116237876020311,-0.0496089283296671,1,0.00593611970059812,0.168237875229108,0.554046914824838,0.597053823765691,-0.658922322635272,0.72383505937219,0.380205737651942,0.598946027375374,0.295824416123839,-0.581073135937623,-0.0367808380246975,-0.0786291183635408,0.228893314940922,0.638168551325898,-0.172041580945112,-0.207608246188489,-0.801355855363678,0.633962998625309,-0.798669498411497,-0.493081099329536,-0.539100989520656,0.27479969556228,0.370511644558014,0.338951075166736,-0.11976211098281,-0.484651904235266,0.000548626710258533,-0.600010182327552,-0.936771405070468,-0.0210700135486799,0.296984337074491,-0.693903761108624,0.100568469351777,-0.0486130338287277,-0.122392560760432,0.0840324683116806,0.487551282313888,0.429453628979227,0.430569410540716,0.128823864481316,0.463930436093155,-0.55339854396528,-0.31009831797799,0.305493073274417,-0.290525149348952,-0.328912216571099,0.590635364110127,-0.576572342068087,0.0310366641022556,-0.0859465846751246,0.00282400987108049,0.855841978664581,-0.649780126398936,-0.622969277336804,-0.201158015339992,0.30792729416968,0.330977557463678,0.424275931477122,0.360703872423156,-0.185313911731058,0.564904889163399,-0.266315706292473,-0.65734507783558,-0.947267801000285,0.700783793853777,-0.222630337964703,-0.613852241962736,-0.48479985764729,-0.692934429339296,-0.0785668917852335,-0.709438699241802,0.114032898828645,0.310370287495839,-0.374720484394322,-0.515069304725566,0.287556041953468,-0.472681450063903,0.693589654772962,0.363878110966621,0.846777692679336,0.0598634598684133,-0.595151589439845,0.485700635381625,0,-0.485700635381625,0.595151589439844,-0.0598634598684133,-0.846777692679336,-0.363878110966621,-0.693589654772962,0.472681450063903,-0.287556041953468,0.515069304725566,0.374720484394322,-0.310370287495839,-0.114032898828645,0.709438699241802,0.0785668917852334,0.692934429339296,0.48479985764729,0.613852241962736,0.222630337964704,-0.700783793853777,0.947267801000285,0.65734507783558,0.266315706292473,-0.564904889163399,0.185313911731058,-0.360703872423156,-0.424275931477123,-0.330977557463678,-0.30792729416968,0.201158015339992,0.622969277336804,0.649780126398936,-0.855841978664581,-0.00282400987108042,0.0859465846751246,-0.0310366641022555,0.576572342068087,-0.590635364110127,0.328912216571099,0.290525149348952,-0.305493073274417,0.31009831797799,0.55339854396528,-0.463930436093155,-0.128823864481316,-0.430569410540716,-0.429453628979227,-0.487551282313888,-0.0840324683116807,0.122392560760432,0.0486130338287275,-0.100568469351778,0.693903761108624,-0.296984337074491,0.02107001354868,0.936771405070468,0.600010182327552,-0.000548626710258587,0.484651904235266,0.11976211098281,-0.338951075166736,-0.370511644558014,-0.27479969556228,0.539100989520655,0.493081099329536,0.798669498411497,-0.633962998625309,0.801355855363678,0.207608246188489,0.172041580945112,-0.638168551325898,-0.228893314940922,0.0786291183635408,0.0367808380246974,0.581073135937623,-0.295824416123839,-0.598946027375374,-0.380205737651942,-0.723835059372189,0.658922322635272,-0.597053823765691,-0.554046914824838,-0.168237875229108,-0.00593611970059812,-1,0.0496089283296671,0.116237876020311,0.729207443992557,0.0202921203619105,0.0191122678477186,-0.12138096992342,-0.571650891276925,0.26287612916898,-0.70220149559829,-0.400031075431511,-0.402874547484304,0.623401319324026,-0.606127818265459,0.31533044468474,-0.0500987578549373,-0.0708267222861086,-0.00365412865649735,0.854339897315515,0.0916144517155109,0.414819031821583,-0.111912583793368,0.104684031861198,-0.754793351638748,-0.510092102605853,0.347517530108627,-0.0571981457515502,-0.045179974990532,0.300499235079636,-0.450847065897033,0.38571749829288,0.12786483585687,-0.21330220517356,-0.0292148175802159,-0.557769492929461,-0.188834296577018,-0.247775713690567,0.912118631199828,-0.540640256727961,-0.445326321035776,-0.599423199405752,-0.181907233995787,0.720087119460895,-0.528392054147402,0,0.528392054147402,-0.720087119460895,0.181907233995787,0.599423199405752,0.445326321035776,0.540640256727961,-0.912118631199828,0.247775713690567,0.188834296577018,0.557769492929461,0.0292148175802159,0.21330220517356,-0.12786483585687,-0.38571749829288,0.450847065897033,-0.300499235079636,0.045179974990532,0.05719814575155,-0.347517530108627,0.510092102605853,0.754793351638748,-0.104684031861198,0.111912583793368,-0.414819031821583,-0.0916144517155108,-0.854339897315515,0.00365412865649728,0.0708267222861086,0.0500987578549373,-0.31533044468474,0.606127818265459,-0.623401319324026,0.402874547484304,0.400031075431511,0.70220149559829,-0.26287612916898,0.571650891276924,0.12138096992342,-0.0191122678477186,-0.0202921203619104,-0.729207443992557,-0.116237876020311,-0.0496089283296671,1,0.00593611970059812,0.168237875229108,0.554046914824838,0.597053823765691,-0.658922322635272,0.72383505937219,0.380205737651942,0.598946027375374,0.295824416123839,-0.581073135937623,-0.0367808380246975,-0.0786291183635408,0.228893314940922,0.638168551325898,-0.172041580945112,-0.207608246188489,-0.801355855363678,0.633962998625309,-0.798669498411497,-0.493081099329536,-0.539100989520656,0.27479969556228,0.370511644558014,0.338951075166736,-0.11976211098281,-0.484651904235266,0.000548626710258533,-0.600010182327552,-0.936771405070468,-0.0210700135486799,0.296984337074491,-0.693903761108624,0.100568469351777,-0.0486130338287277,-0.122392560760432,0.0840324683116806,0.487551282313888,0.429453628979227,0.430569410540716,0.128823864481316,0.463930436093155,-0.55339854396528,-0.31009831797799,0.305493073274417,-0.290525149348952,-0.328912216571099,0.590635364110127,-0.576572342068087,0.0310366641022556,-0.0859465846751246,0.00282400987108049,0.855841978664581,-0.649780126398936,-0.622969277336804,-0.201158015339992,0.30792729416968,0.330977557463678,0.424275931477122,0.360703872423156,-0.185313911731058,0.564904889163399,-0.266315706292473,-0.65734507783558,-0.947267801000285,0.700783793853777,-0.222630337964703,-0.613852241962736,-0.48479985764729,-0.692934429339296,-0.0785668917852335,-0.709438699241802,0.114032898828645,0.310370287495839,-0.374720484394322,-0.515069304725566,0.287556041953468,-0.472681450063903,0.693589654772962,0.363878110966621,0.846777692679336,0.0598634598684133,-0.595151589439845,0.485700635381625,0,-0.485700635381625,0.595151589439844,-0.0598634598684133,-0.846777692679336,-0.363878110966621,-0.693589654772962,0.472681450063903,-0.287556041953468,0.515069304725566,0.374720484394322,-0.310370287495839,-0.114032898828645,0.709438699241802,0.0785668917852334,0.692934429339296,0.48479985764729,0.613852241962736,0.222630337964704,-0.700783793853777,0.947267801000285,0.65734507783558,0.266315706292473,-0.564904889163399,0.185313911731058,-0.360703872423156,-0.424275931477123,-0.330977557463678,-0.30792729416968,0.201158015339992,0.622969277336804,0.649780126398936,-0.855841978664581,-0.00282400987108042,0.0859465846751246,-0.0310366641022555,0.576572342068087,-0.590635364110127,0.328912216571099,0.290525149348952,-0.305493073274417,0.31009831797799,0.55339854396528,-0.463930436093155,-0.128823864481316,-0.430569410540716,-0.429453628979227,-0.487551282313888,-0.0840324683116807,0.122392560760432,0.0486130338287275,-0.100568469351778,0.693903761108624,-0.296984337074491,0.02107001354868,0.936771405070468,0.600010182327552,-0.000548626710258587,0.484651904235266,0.11976211098281,-0.338951075166736,-0.370511644558014,-0.27479969556228,0.539100989520655,0.493081099329536,0.798669498411497,-0.633962998625309,0.801355855363678,0.207608246188489,0.172041580945112,-0.638168551325898,-0.228893314940922,0.0786291183635408,0.0367808380246974,0.581073135937623,-0.295824416123839,-0.598946027375374,-0.380205737651942,-0.723835059372189,0.658922322635272,-0.597053823765691,-0.554046914824838,-0.168237875229108,-0.00593611970059812,-1,0.0496089283296671,0.116237876020311,0.729207443992557,0.0202921203619105,0.0191122678477186,-0.12138096992342,-0.571650891276925,0.26287612916898,-0.70220149559829,-0.400031075431511,-0.402874547484304,0.623401319324026,-0.606127818265459,0.31533044468474,-0.0500987578549373,-0.0708267222861086,-0.00365412865649735,0.854339897315515,0.0916144517155109,0.414819031821583,-0.111912583793368,0.104684031861198,-0.754793351638748,-0.510092102605853,0.347517530108627,-0.0571981457515502,-0.045179974990532,0.300499235079636,-0.450847065897033,0.38571749829288,0.12786483585687,-0.21330220517356,-0.0292148175802159,-0.557769492929461,-0.188834296577018,-0.247775713690567,0.912118631199828,-0.540640256727961,-0.445326321035776,-0.599423199405752,-0.181907233995787,0.720087119460895,-0.528392054147402,0,0.528392054147402,-0.720087119460895,0.181907233995787,0.599423199405752,0.445326321035776,0.540640256727961,-0.912118631199828,0.247775713690567,0.188834296577018,0.557769492929461,0.0292148175802159,0.21330220517356,-0.12786483585687,-0.38571749829288,0.450847065897033,-0.300499235079636,0.045179974990532,0.05719814575155,-0.347517530108627,0.510092102605853,0.754793351638748,-0.104684031861198,0.111912583793368,-0.414819031821583,-0.0916144517155108,-0.854339897315515,0.00365412865649728,0.0708267222861086,0.0500987578549373,-0.31533044468474,0.606127818265459,-0.623401319324026,0.402874547484304,0.400031075431511,0.70220149559829,-0.26287612916898,0.571650891276924,0.12138096992342,-0.0191122678477186,-0.0202921203619104,-0.729207443992557,-0.116237876020311,-0.0496089283296671,1,0.00593611970059812,0.168237875229108,0.554046914824838,0.597053823765691,-0.658922322635272,0.72383505937219,0.380205737651942,0.598946027375374,0.295824416123839,-0.581073135937623,-0.0367808380246975,-0.0786291183635408,0.228893314940922,0.638168551325898,-0.172041580945112,-0.207608246188489,-0.801355855363678,0.633962998625309,-0.798669498411497,-0.493081099329536,-0.539100989520656,0.27479969556228,0.370511644558014,0.338951075166736,-0.11976211098281,-0.484651904235266,0.000548626710258533,-0.600010182327552,-0.936771405070468,-0.0210700135486799,0.296984337074491,-0.693903761108624,0.100568469351777,-0.0486130338287277,-0.122392560760432,0.0840324683116806,0.487551282313888,0.429453628979227,0.430569410540716,0.128823864481316,0.463930436093155,-0.55339854396528,-0.31009831797799,0.305493073274417,-0.290525149348952,-0.328912216571099,0.590635364110127,-0.576572342068087,0.0310366641022556,-0.0859465846751246,0.00282400987108049,0.855841978664581,-0.649780126398936,-0.622969277336804,-0.201158015339992,0.30792729416968,0.330977557463678,0.424275931477122,0.360703872423156,-0.185313911731058,0.564904889163399,-0.266315706292473,-0.65734507783558,-0.947267801000285,0.700783793853777,-0.222630337964703,-0.613852241962736,-0.48479985764729,-0.692934429339296,-0.0785668917852335,-0.709438699241802,0.114032898828645,0.310370287495839,-0.374720484394322,-0.515069304725566,0.287556041953468,-0.472681450063903,0.693589654772962,0.363878110966621,0.846777692679336,0.0598634598684133,-0.595151589439845,0.485700635381625,0,-0.485700635381625,0.595151589439844,-0.0598634598684133,-0.846777692679336,-0.363878110966621,-0.693589654772962,0.472681450063903,-0.287556041953468,0.515069304725566,0.374720484394322,-0.310370287495839,-0.114032898828645,0.709438699241802,0.0785668917852334,0.692934429339296,0.48479985764729,0.613852241962736,0.222630337964704,-0.700783793853777,0.947267801000285,0.65734507783558,0.266315706292473,-0.564904889163399,0.185313911731058,-0.360703872423156,-0.424275931477123,-0.330977557463678,-0.30792729416968,0.201158015339992,0.622969277336804,0.649780126398936,-0.855841978664581,-0.00282400987108042,0.0859465846751246,-0.0310366641022555,0.576572342068087,-0.590635364110127,0.328912216571099,0.290525149348952,-0.305493073274417,0.31009831797799,0.55339854396528,-0.463930436093155,-0.128823864481316,-0.430569410540716,-0.429453628979227,-0.487551282313888,-0.0840324683116807,0.122392560760432,0.0486130338287275,-0.100568469351778,0.693903761108624,-0.296984337074491,0.02107001354868,0.936771405070468,0.600010182327552,-0.000548626710258587,0.484651904235266,0.11976211098281,-0.338951075166736,-0.370511644558014,-0.27479969556228,0.539100989520655,0.493081099329536,0.798669498411497,-0.633962998625309,0.801355855363678,0.207608246188489,0.172041580945112,-0.638168551325898,-0.228893314940922,0.0786291183635408,0.0367808380246974,0.581073135937623,-0.295824416123839,-0.598946027375374,-0.380205737651942,-0.723835059372189,0.658922322635272,-0.597053823765691,-0.554046914824838,-0.168237875229108,-0.00593611970059812,-1,0.0496089283296671,0.116237876020311,0.729207443992557,0.0202921203619105,0.0191122678477186,-0.12138096992342,-0.571650891276925,0.26287612916898,-0.70220149559829,-0.400031075431511,-0.402874547484304,0.623401319324026,-0.606127818265459,0.31533044468474,-0.0500987578549373,-0.0708267222861086,-0.00365412865649735,0.854339897315515,0.0916144517155109,0.414819031821583,-0.111912583793368,0.104684031861198,-0.754793351638748,-0.510092102605853,0.347517530108627,-0.0571981457515502,-0.045179974990532,0.300499235079636,-0.450847065897033,0.38571749829288,0.12786483585687,-0.21330220517356,-0.0292148175802159,-0.557769492929461,-0.188834296577018,-0.247775713690567,0.912118631199828,-0.540640256727961,-0.445326321035776,-0.599423199405752,-0.181907233995787,0.720087119460895,-0.528392054147402};
static const float real_wave_table[8192] = {0.739621648994303,0.509466839989205,-0.46952241411734,-0.165040642245623,-0.354966700071377,-0.583016630068732,0.555506481343477,-0.800081235317648,-0.207936206041879,0.335857300251279,0.506543174746518,0.275544802113016,-0.0562993607584472,-0.236574606606571,-0.656314594224107,0.540677577583138,-0.663008284959907,-0.257153867119092,0.0100520397898151,0.400612651167658,0.224195340490572,0.45884267538835,0.360569682469195,-0.692068883017846,0.661087559676598,0.508765314806533,0.55625143051062,0.244839269105035,-0.515542455833603,0.682509490734523,0.732913899415481,-0.120135296962202,0.551191264164674,0.559530817805219,-0.247941027810711,-0.662564186320989,-0.120498988872033,-0.211443876983019,-0.0581630956576357,0.0938815459973973,0.792899073064808,0.517032019101428,0.120554910288323,-0.0684952366873714,-0.674603210663576,0.850080943417085,0.0974063598616333,0.0428353491747957,0.114660002111066,0.00316744090411976,0.823551275730541,0.401269130005557,0.151871174940385,-0.423807994728316,-0.0185125304809186,0.0285045029097103,-0.000824167005254877,0.862259801989543,-0.122444655870471,0.0489302576433684,0.0273519942933725,-0.587078603605229,0.480953459342105,0.110002583821532,-0.657441465772714,-0.125580390075665,-0.428640654140569,-0.584713152718307,-0.530107256279591,-0.415743660452446,0.456581423786473,-0.75325020721495,-0.76061174036191,0.275389916849049,0.536035964661723,-0.430196609080237,0.362677389488653,0.587705853200292,0.0474368080314847,0.0949918963447461,-0.607741101440601,-0.284499736052676,-0.376358217908618,0.668162496228335,-0.210579173293928,0.425103442978148,-0.148377539533663,-0.553908992460109,0.753835927029283,0.00676006615929557,-0.348676641712596,-0.435170431569671,-0.309478326412812,0.0651803783549638,-0.205212591693503,-0.281452676050032,0.434970934494397,-0.55277131026051,-0.495381078252481,-0.558238719167953,0.610927959732032,0.192811408038322,0.116812612483378,-0.165240874217672,-0.580737944386806,0.972880240045015,-0.24078538983052,-0.412592704441109,-0.245614498666339,-0.207901953171141,0.00705244751995962,0.356537923183199,0.169927185630372,0.573589340468571,0.382249423661417,0.162362327102706,-0.401649274401639,-0.447852703869475,0.722767787515313,-0.0546673877842577,-0.65771250197484,-0.363960005435732,0.179744591550652,-0.865491986253419,-0.587450476782526,-0.0275567022321909,-0.246887478384117,0.472165659309055,0.575261282551125,0.472165659309055,-0.246887478384117,-0.0275567022321909,-0.587450476782526,-0.865491986253419,0.179744591550652,-0.363960005435732,-0.65771250197484,-0.0546673877842577,0.722767787515313,-0.447852703869475,-0.401649274401639,0.162362327102706,0.382249423661417,0.573589340468571,0.169927185630372,0.356537923183199,0.00705244751995965,-0.207901953171141,-0.245614498666339,-0.41259270444111,-0.24078538983052,0.972880240045015,-0.580737944386806,-0.165240874217672,0.116812612483378,0.192811408038322,0.610927959732032,-0.558238719167953,-0.495381078252481,-0.55277131026051,0.434970934494397,-0.281452676050032,-0.205212591693503,0.065180378354964,-0.309478326412812,-0.435170431569671,-0.348676641712596,0.00676006615929543,0.753835927029283,-0.55390899246011,-0.148377539533663,0.425103442978148,-0.210579173293928,0.668162496228335,-0.376358217908618,-0.284499736052676,-0.607741101440601,0.094991896344746,0.0474368080314848,0.587705853200292,0.362677389488653,-0.430196609080237,0.536035964661723,0.275389916849049,-0.76061174036191,-0.75325020721495,0.456581423786473,-0.415743660452446,-0.530107256279591,-0.584713152718307,-0.428640654140569,-0.125580390075665,-0.657441465772714,0.110002583821532,0.480953459342105,-0.587078603605229,0.0273519942933726,0.0489302576433684,-0.122444655870471,0.862259801989543,-0.00082416700525495,0.0285045029097104,-0.0185125304809186,-0.423807994728316,0.151871174940385,0.401269130005557,0.823551275730541,0.00316744090411969,0.114660002111066,0.0428353491747957,0.0974063598616334,0.850080943417086,-0.674603210663576,-0.0684952366873714,0.120554910288323,0.517032019101428,0.792899073064808,0.0938815459973972,-0.0581630956576358,-0.211443876983019,-0.120498988872033,-0.662564186320989,-0.247941027810711,0.559530817805219,0.551191264164674,-0.120135296962202,0.732913899415482,0.682509490734523,-0.515542455833603,0.244839269105035,0.55625143051062,0.508765314806533,0.661087559676598,-0.692068883017845,0.360569682469195,0.45884267538835,0.224195340490572,0.400612651167658,0.0100520397898152,-0.257153867119092,-0.663008284959908,0.540677577583138,-0.656314594224107,-0.236574606606571,-0.0562993607584472,0.275544802113016,0.506543174746518,0.335857300251278,-0.207936206041879,-0.800081235317648,0.555506481343477,-0.583016630068732,-0.354966700071377,-0.165040642245623,-0.46952241411734,0.509466839989205,0.739621648994303,0.509466839989205,-0.46952241411734,-0.165040642245623,-0.354966700071377,-0.583016630068732,0.555506481343477,-0.800081235317648,-0.207936206041879,0.335857300251279,0.506543174746518,0.275544802113016,-0.0562993607584472,-0.236574606606571,-0.656314594224107,0.540677577583138,-0.663008284959907,-0.257153867119092,0.0100520397898151,0.400612651167658,0.224195340490572,0.45884267538835,0.360569682469195,-0.692068883017846,0.661087559676598,0.508765314806533,0.55625143051062,0.244839269105035,-0.515542455833603,0.682509490734523,0.732913899415481,-0.120135296962202,0.551191264164674,0.559530817805219,-0.247941027810711,-0.662564186320989,-0.120498988872033,-0.211443876983019,-0.0581630956576357,0.0938815459973973,0.792899073064808,0.517032019101428,0.120554910288323,-0.0684952366873714,-0.674603210663576,0.850080943417085,0.0974063598616333,0.0428353491747957,0.114660002111066,0.00316744090411976,0.823551275730541,0.401269130005557,0.151871174940385,-0.423807994728316,-0.0185125304809186,0.0285045029097103,-0.000824167005254877,0.862259801989543,-0.122444655870471,0.0489302576433684,0.0273519942933725,-0.587078603605229,0.480953459342105,0.110002583821532,-0.657441465772714,-0.125580390075665,-0.428640654140569,-0.584713152718307,-0.530107256279591,-0.415743660452446,0.456581423786473,-0.75325020721495,-0.76061174036191,0.275389916849049,0.536035964661723,-0.430196609080237,0.362677389488653,0.587705853200292,0.0474368080314847,0.0949918963447461,-0.607741101440601,-0.284499736052676,-0.376358217908618,0.668162496228335,-0.210579173293928,0.425103442978148,-0.148377539533663,-0.553908992460109,0.753835927029283,0.00676006615929557,-0.348676641712596,-0.435170431569671,-0.309478326412812,0.0651803783549638,-0.205212591693503,-0.281452676050032,0.434970934494397,-0.55277131026051,-0.495381078252481,-0.558238719167953,0.610927959732032,0.192811408038322,0.116812612483378,-0.165240874217672,-0.580737944386806,0.972880240045015,-0.24078538983052,-0.412592704441109,-0.245614498666339,-0.207901953171141,0.00705244751995962,0.356537923183199,0.169927185630372,0.573589340468571,0.382249423661417,0.162362327102706,-0.401649274401639,-0.447852703869475,0.722767787515313,-0.0546673877842577,-0.65771250197484,-0.363960005435732,0.179744591550652,-0.865491986253419,-0.587450476782526,-0.0275567022321909,-0.246887478384117,0.472165659309055,0.575261282551125,0.472165659309055,-0.246887478384117,-0.0275567022321909,-0.587450476782526,-0.865491986253419,0.179744591550652,-0.363960005435732,-0.65771250197484,-0.0546673877842577,0.722767787515313,-0.447852703869475,-0.401649274401639,0.162362327102706,0.382249423661417,0.573589340468571,0.169927185630372,0.356537923183199,0.00705244751995965,-0.207901953171141,-0.245614498666339,-0.41259270444111,-0.24078538983052,0.972880240045015,-0.580737944386806,-0.165240874217672,0.116812612483378,0.192811408038322,0.610927959732032,-0.558238719167953,-0.495381078252481,-0.55277131026051,0.434970934494397,-0.281452676050032,-0.205212591693503,0.065180378354964,-0.309478326412812,-0.435170431569671,-0.348676641712596,0.00676006615929543,0.753835927029283,-0.55390899246011,-0.148377539533663,0.425103442978148,-0.210579173293928,0.668162496228335,-0.376358217908618,-0.284499736052676,-0.607741101440601,0.094991896344746,0.0474368080314848,0.587705853200292,0.362677389488653,-0.430196609080237,0.536035964661723,0.275389916849049,-0.76061174036191,-0.75325020721495,0.456581423786473,-0.415743660452446,-0.530107256279591,-0.584713152718307,-0.428640654140569,-0.125580390075665,-0.657441465772714,0.110002583821532,0.480953459342105,-0.587078603605229,0.0273519942933726,0.0489302576433684,-0.122444655870471,0.862259801989543,-0.00082416700525495,0.0285045029097104,-0.0185125304809186,-0.423807994728316,0.151871174940385,0.401269130005557,0.823551275730541,0.00316744090411969,0.114660002111066,0.0428353491747957,0.0974063598616334,0.850080943417086,-0.674603210663576,-0.0684952366873714,0.120554910288323,0.517032019101428,0.792899073064808,0.0938815459973972,-0.0581630956576358,-0.211443876983019,-0.120498988872033,-0.662564186320989,-0.247941027810711,0.559530817805219,0.551191264164674,-0.120135296962202,0.732913899415482,0.682509490734523,-0.515542455833603,0.244839269105035,0.55625143051062,0.508765314806533,0.661087559676598,-0.692068883017845,0.360569682469195,0.45884267538835,0.224195340490572,0.400612651167658,0.0100520397898152,-0.257153867119092,-0.663008284959908,0.540677577583138,-0.656314594224107,-0.236574606606571,-0.0562993607584472,0.275544802113016,0.506543174746518,0.335857300251278,-0.207936206041879,-0.800081235317648,0.555506481343477,-0.583016630068732,-0.354966700071377,-0.165040642245623,-0.46952241411734,0.509466839989205,0.739621648994303,0.509466839989205,-0.46952241411734,-0.165040642245623,-0.354966700071377,-0.583016630068732,0.555506481343477,-0.800081235317648,-0.207936206041879,0.335857300251279,0.506543174746518,0.275544802113016,-0.0562993607584472,-0.236574606606571,-0.656314594224107,0.540677577583138,-0.663008284959907,-0.257153867119092,0.0100520397898151,0.400612651167658,0.224195340490572,0.45884267538835,0.360569682469195,-0.692068883017846,0.661087559676598,0.508765314806533,0.55625143051062,0.244839269105035,-0.515542455833603,0.682509490734523,0.732913899415481,-0.120135296962202,0.551191264164674,0.559530817805219,-0.247941027810711,-0.662564186320989,-0.120498988872033,-0.211443876983019,-0.0581630956576357,0.0938815459973973,0.792899073064808,0.517032019101428,0.120554910288323,-0.0684952366873714,-0.674603210663576,0.850080943417085,0.0974063598616333,0.0428353491747957,0.114660002111066,0.00316744090411976,0.823551275730541,0.401269130005557,0.151871174940385,-0.423807994728316,-0.0185125304809186,0.0285045029097103,-0.000824167005254877,0.862259801989543,-0.122444655870471,0.0489302576433684,0.0273519942933725,-0.587078603605229,0.480953459342105,0.110002583821532,-0.657441465772714,-0.125580390075665,-0.428640654140569,-0.584713152718307,-0.530107256279591,-0.415743660452446,0.456581423786473,-0.75325020721495,-0.76061174036191,0.275389916849049,0.536035964661723,-0.430196609080237,0.362677389488653,0.587705853200292,0.0474368080314847,0.0949918963447461,-0.607741101440601,-0.284499736052676,-0.376358217908618,0.668162496228335,-0.210579173293928,0.425103442978148,-0.148377539533663,-0.553908992460109,0.753835927029283,0.00676006615929557,-0.348676641712596,-0.435170431569671,-0.309478326412812,0.0651803783549638,-0.205212591693503,-0.281452676050032,0.434970934494397,-0.55277131026051,-0.495381078252481,-0.558238719167953,0.610927959732032,0.192811408038322,0.116812612483378,-0.165240874217672,-0.580737944386806,0.972880240045015,-0.24078538983052,-0.412592704441109,-0.245614498666339,-0.207901953171141,0.00705244751995962,0.356537923183199,0.169927185630372,0.573589340468571,0.382249423661417,0.162362327102706,-0.401649274401639,-0.447852703869475,0.722767787515313,-0.0546673877842577,-0.65771250197484,-0.363960005435732,0.179744591550652,-0.865491986253419,-0.587450476782526,-0.0275567022321909,-0.246887478384117,0.472165659309055,0.575261282551125,0.472165659309055,-0.246887478384117,-0.0275567022321909,-0.587450476782526,-0.865491986253419,0.179744591550652,-0.363960005435732,-0.65771250197484,-0.0546673877842577,0.722767787515313,-0.447852703869475,-0.401649274401639,0.162362327102706,0.382249423661417,0.573589340468571,0.169927185630372,0.356537923183199,0.00705244751995965,-0.207901953171141,-0.245614498666339,-0.41259270444111,-0.24078538983052,0.972880240045015,-0.580737944386806,-0.165240874217672,0.116812612483378,0.192811408038322,0.610927959732032,-0.558238719167953,-0.495381078252481,-0.55277131026051,0.434970934494397,-0.281452676050032,-0.205212591693503,0.065180378354964,-0.309478326412812,-0.435170431569671,-0.348676641712596,0.00676006615929543,0.753835927029283,-0.55390899246011,-0.148377539533663,0.425103442978148,-0.210579173293928,0.668162496228335,-0.376358217908618,-0.284499736052676,-0.607741101440601,0.094991896344746,0.0474368080314848,0.587705853200292,0.362677389488653,-0.430196609080237,0.536035964661723,0.275389916849049,-0.76061174036191,-0.75325020721495,0.456581423786473,-0.415743660452446,-0.530107256279591,-0.584713152718307,-0.428640654140569,-0.125580390075665,-0.657441465772714,0.110002583821532,0.480953459342105,-0.587078603605229,0.0273519942933726,0.0489302576433684,-0.122444655870471,0.862259801989543,-0.00082416700525495,0.0285045029097104,-0.0185125304809186,-0.423807994728316,0.151871174940385,0.401269130005557,0.823551275730541,0.00316744090411969,0.114660002111066,0.0428353491747957,0.0974063598616334,0.850080943417086,-0.674603210663576,-0.0684952366873714,0.120554910288323,0.517032019101428,0.792899073064808,0.0938815459973972,-0.0581630956576358,-0.211443876983019,-0.120498988872033,-0.662564186320989,-0.247941027810711,0.559530817805219,0.551191264164674,-0.120135296962202,0.732913899415482,0.682509490734523,-0.515542455833603,0.244839269105035,0.55625143051062,0.508765314806533,0.661087559676598,-0.692068883017845,0.360569682469195,0.45884267538835,0.224195340490572,0.400612651167658,0.0100520397898152,-0.257153867119092,-0.663008284959908,0.540677577583138,-0.656314594224107,-0.236574606606571,-0.0562993607584472,0.275544802113016,0.506543174746518,0.335857300251278,-0.207936206041879,-0.800081235317648,0.555506481343477,-0.583016630068732,-0.354966700071377,-0.165040642245623,-0.46952241411734,0.509466839989205,0.739621648994303,0.509466839989205,-0.46952241411734,-0.165040642245623,-0.354966700071377,-0.583016630068732,0.555506481343477,-0.800081235317648,-0.207936206041879,0.335857300251279,0.506543174746518,0.275544802113016,-0.0562993607584472,-0.236574606606571,-0.656314594224107,0.540677577583138,-0.663008284959907,-0.257153867119092,0.0100520397898151,0.400612651167658,0.224195340490572,0.45884267538835,0.360569682469195,-0.692068883017846,0.661087559676598,0.508765314806533,0.55625143051062,0.244839269105035,-0.515542455833603,0.682509490734523,0.732913899415481,-0.120135296962202,0.551191264164674,0.559530817805219,-0.247941027810711,-0.662564186320989,-0.120498988872033,-0.211443876983019,-0.0581630956576357,0.0938815459973973,0.792899073064808,0.517032019101428,0.120554910288323,-0.0684952366873714,-0.674603210663576,0.850080943417085,0.0974063598616333,0.0428353491747957,0.114660002111066,0.00316744090411976,0.823551275730541,0.401269130005557,0.151871174940385,-0.423807994728316,-0.0185125304809186,0.0285045029097103,-0.000824167005254877,0.862259801989543,-0.122444655870471,0.0489302576433684,0.0273519942933725,-0.587078603605229,0.480953459342105,0.110002583821532,-0.657441465772714,-0.125580390075665,-0.428640654140569,-0.584713152718307,-0.530107256279591,-0.415743660452446,0.456581423786473,-0.75325020721495,-0.76061174036191,0.275389916849049,0.536035964661723,-0.430196609080237,0.362677389488653,0.587705853200292,0.0474368080314847,0.0949918963447461,-0.607741101440601,-0.284499736052676,-0.376358217908618,0.668162496228335,-0.210579173293928,0.425103442978148,-0.148377539533663,-0.553908992460109,0.753835927029283,0.00676006615929557,-0.348676641712596,-0.435170431569671,-0.309478326412812,0.0651803783549638,-0.205212591693503,-0.281452676050032,0.434970934494397,-0.55277131026051,-0.495381078252481,-0.558238719167953,0.610927959732032,0.192811408038322,0.116812612483378,-0.165240874217672,-0.580737944386806,0.972880240045015,-0.24078538983052,-0.412592704441109,-0.245614498666339,-0.207901953171141,0.00705244751995962,0.356537923183199,0.169927185630372,0.573589340468571,0.382249423661417,0.162362327102706,-0.401649274401639,-0.447852703869475,0.722767787515313,-0.0546673877842577,-0.65771250197484,-0.363960005435732,0.179744591550652,-0.865491986253419,-0.587450476782526,-0.0275567022321909,-0.246887478384117,0.472165659309055,0.575261282551125,0.472165659309055,-0.246887478384117,-0.0275567022321909,-0.587450476782526,-0.865491986253419,0.179744591550652,-0.363960005435732,-0.65771250197484,-0.0546673877842577,0.722767787515313,-0.447852703869475,-0.401649274401639,0.162362327102706,0.382249423661417,0.573589340468571,0.169927185630372,0.356537923183199,0.00705244751995965,-0.207901953171141,-0.245614498666339,-0.41259270444111,-0.24078538983052,0.972880240045015,-0.580737944386806,-0.165240874217672,0.116812612483378,0.192811408038322,0.610927959732032,-0.558238719167953,-0.495381078252481,-0.55277131026051,0.434970934494397,-0.281452676050032,-0.205212591693503,0.065180378354964,-0.309478326412812,-0.435170431569671,-0.348676641712596,0.00676006615929543,0.753835927029283,-0.55390899246011,-0.148377539533663,0.425103442978148,-0.210579173293928,0.668162496228335,-0.376358217908618,-0.284499736052676,-0.607741101440601,0.094991896344746,0.0474368080314848,0.587705853200292,0.362677389488653,-0.430196609080237,0.536035964661723,0.275389916849049,-0.76061174036191,-0.75325020721495,0.456581423786473,-0.415743660452446,-0.530107256279591,-0.584713152718307,-0.428640654140569,-0.125580390075665,-0.657441465772714,0.110002583821532,0.480953459342105,-0.587078603605229,0.0273519942933726,0.0489302576433684,-0.122444655870471,0.862259801989543,-0.00082416700525495,0.0285045029097104,-0.0185125304809186,-0.423807994728316,0.151871174940385,0.401269130005557,0.823551275730541,0.00316744090411969,0.114660002111066,0.0428353491747957,0.0974063598616334,0.850080943417086,-0.674603210663576,-0.0684952366873714,0.120554910288323,0.517032019101428,0.792899073064808,0.0938815459973972,-0.0581630956576358,-0.211443876983019,-0.120498988872033,-0.662564186320989,-0.247941027810711,0.559530817805219,0.551191264164674,-0.120135296962202,0.732913899415482,0.682509490734523,-0.515542455833603,0.244839269105035,0.55625143051062,0.508765314806533,0.661087559676598,-0.692068883017845,0.360569682469195,0.45884267538835,0.224195340490572,0.400612651167658,0.0100520397898152,-0.257153867119092,-0.663008284959908,0.540677577583138,-0.656314594224107,-0.236574606606571,-0.0562993607584472,0.275544802113016,0.506543174746518,0.335857300251278,-0.207936206041879,-0.800081235317648,0.555506481343477,-0.583016630068732,-0.354966700071377,-0.165040642245623,-0.46952241411734,0.509466839989205,0.739621648994303,0.509466839989205,-0.46952241411734,-0.165040642245623,-0.354966700071377,-0.583016630068732,0.555506481343477,-0.800081235317648,-0.207936206041879,0.335857300251279,0.506543174746518,0.275544802113016,-0.0562993607584472,-0.236574606606571,-0.656314594224107,0.540677577583138,-0.663008284959907,-0.257153867119092,0.0100520397898151,0.400612651167658,0.224195340490572,0.45884267538835,0.360569682469195,-0.692068883017846,0.661087559676598,0.508765314806533,0.55625143051062,0.244839269105035,-0.515542455833603,0.682509490734523,0.732913899415481,-0.120135296962202,0.551191264164674,0.559530817805219,-0.247941027810711,-0.662564186320989,-0.120498988872033,-0.211443876983019,-0.0581630956576357,0.0938815459973973,0.792899073064808,0.517032019101428,0.120554910288323,-0.0684952366873714,-0.674603210663576,0.850080943417085,0.0974063598616333,0.0428353491747957,0.114660002111066,0.00316744090411976,0.823551275730541,0.401269130005557,0.151871174940385,-0.423807994728316,-0.0185125304809186,0.0285045029097103,-0.000824167005254877,0.862259801989543,-0.122444655870471,0.0489302576433684,0.0273519942933725,-0.587078603605229,0.480953459342105,0.110002583821532,-0.657441465772714,-0.125580390075665,-0.428640654140569,-0.584713152718307,-0.530107256279591,-0.415743660452446,0.456581423786473,-0.75325020721495,-0.76061174036191,0.275389916849049,0.536035964661723,-0.430196609080237,0.362677389488653,0.587705853200292,0.0474368080314847,0.0949918963447461,-0.607741101440601,-0.284499736052676,-0.376358217908618,0.668162496228335,-0.210579173293928,0.425103442978148,-0.148377539533663,-0.553908992460109,0.753835927029283,0.00676006615929557,-0.348676641712596,-0.435170431569671,-0.309478326412812,0.0651803783549638,-0.205212591693503,-0.281452676050032,0.434970934494397,-0.55277131026051,-0.495381078252481,-0.558238719167953,0.610927959732032,0.192811408038322,0.116812612483378,-0.165240874217672,-0.580737944386806,0.972880240045015,-0.24078538983052,-0.412592704441109,-0.245614498666339,-0.207901953171141,0.00705244751995962,0.356537923183199,0.169927185630372,0.573589340468571,0.382249423661417,0.162362327102706,-0.401649274401639,-0.447852703869475,0.722767787515313,-0.0546673877842577,-0.65771250197484,-0.363960005435732,0.179744591550652,-0.865491986253419,-0.587450476782526,-0.0275567022321909,-0.246887478384117,0.472165659309055};

class wave_table_class
{
public:
    wave_table_class(const std::string& wave_type, const float ampl)
        : _wave_table(wave_table_len)
    {
        std::cout << "ampl: " << ampl << std::endl;
        // compute real wave table with 1.0 amplitude

        // compute i and q pairs with 90% offset and scale to amplitude
        for (size_t i = 0; i < wave_table_len; i++) {
            _wave_table[i] =
                std::complex<float>(ampl * real_wave_table[i], ampl * imag_wave_table[i]);
        }
    }

    inline std::complex<float> operator()(const size_t index) const
    {
        return _wave_table[index % wave_table_len];
    }

private:
    std::vector<std::complex<float>> _wave_table;
};
